{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useCallback, useEffect } from 'react';\nimport AppLayout from '../components/AppLayout';\nimport Head from 'next/head';\nimport { Card, Avatar, Button } from 'antd';\nimport styled from 'styled-components';\nimport EditUser from '../components/EditUser';\nimport EditBucket from '../components/EditBucket';\nimport { useSelector, useDispatch } from 'react-redux';\nimport Router from 'next/router';\nimport { LOG_OUT_REQUEST, LOAD_MY_INFO_REQUEST } from '../reducers/user';\nimport { LOAD_BUCKET_REQUEST } from '../reducers/bucket';\nimport axios from 'axios';\nimport { END } from 'redux-saga';\nimport wrapper from '../store/configureStore';\nconst CenterDiv = styled.div.withConfig({\n  displayName: \"profile__CenterDiv\",\n  componentId: \"u1xmpn-0\"\n})([\"width:75%;margin:0 auto;\"]);\nconst CustomCard = styled(Card).withConfig({\n  displayName: \"profile__CustomCard\",\n  componentId: \"u1xmpn-1\"\n})([\"margin-top:20px;\"]);\n\nconst Profile = () => {\n  const {\n    isLoggedIn,\n    user\n  } = useSelector(state => state.user);\n  const dispatch = useDispatch();\n  useEffect(() => {\n    if (!isLoggedIn) {\n      Router.push('/login');\n    }\n  }, [isLoggedIn]);\n\n  if (!isLoggedIn) {\n    return '내 정보 로딩중...';\n  }\n\n  const {\n    0: value,\n    1: setValue\n  } = useState(false); //정보 수정 클릭\n\n  const onClickUser = useCallback(() => {\n    setValue(false);\n  }, [value]); //버킷리스트 수정 클릭\n\n  const onClickBucket = useCallback(e => {\n    dispatch({\n      type: LOAD_BUCKET_REQUEST\n    });\n    setValue(true);\n  }, [value]);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsxs(Head, {\n      children: [/*#__PURE__*/_jsx(\"meta\", {\n        charSet: \"utf-8\"\n      }), /*#__PURE__*/_jsx(\"title\", {\n        children: \"Profile\"\n      })]\n    }), isLoggedIn && /*#__PURE__*/_jsx(AppLayout, {\n      children: /*#__PURE__*/_jsxs(CenterDiv, {\n        children: [/*#__PURE__*/_jsx(CustomCard, {\n          actions: [/*#__PURE__*/_jsxs(\"div\", {\n            onClick: onClickUser,\n            children: [\"\\uC815\\uBCF4 \\uC218\\uC815\", /*#__PURE__*/_jsx(\"br\", {})]\n          }, \"twit\"), /*#__PURE__*/_jsxs(\"div\", {\n            onClick: onClickBucket,\n            children: [\"\\uBC84\\uD0B7\\uB9AC\\uC2A4\\uD2B8 \\uAD00\\uB9AC\", /*#__PURE__*/_jsx(\"br\", {})]\n          }, \"followings\")],\n          children: /*#__PURE__*/_jsx(Card.Meta, {\n            avatar: /*#__PURE__*/_jsx(Avatar, {}),\n            title: user.nickname\n          })\n        }), value ? /*#__PURE__*/_jsx(EditBucket, {}) : /*#__PURE__*/_jsx(EditUser, {})]\n      })\n    })]\n  });\n}; //SSR 적용 - getServerSidProps 사용\n\n\nexport const getServerSideProps = wrapper.getServerSideProps(async context => {\n  //Brower 에서 요청이 아닌 Front -> Back이므로 쿠키를 전달해줘야 한다.\n  const cookie = context.req ? context.req.headers.cookie : '';\n  axios.defaults.headers.Cookie = cookie; //요청 헤더에 쿠키 넣기.\n\n  context.store.dispatch({\n    type: LOAD_MY_INFO_REQUEST\n  });\n  context.store.dispatch(END);\n  await context.store.sagaTask.toPromise();\n});\nexport default Profile;","map":null,"metadata":{},"sourceType":"module"}